---
title: "Regional Trends in Renewable Energy Investment"
description: |
  A short description of the post.
author:
  - name: Joe DeCesaro
    url: {}
date: 11-23-2021
output:
  distill::distill_article:
    self_contained: false
draft: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
library(tidyverse)
library(here)
library(readxl)
library(janitor)
library(broom)
library(sjPlot)
library(paletteer)
library(kableExtra)
```


# What is the trend of renewable energy investment over time?

Implementation of renewable energy into electric grids around the world will be key to curbing the effects of climate change. It is no secret that change usually occurs where money flows. In the past, renewable energy technologies such as solar and wind have been expensive forms of generating electricity but, over the last ten years there has been a steep decline in their costs. From 2009 to 2019 the price of electricity from solar power has dropped 89% and the wind has dropped 70% (Roser, 2020). This begs the question, how is investment in renewable technologies changing over time? How does this compare to investment in non-renewable energy?

This question is important to know for the future of climate change. As climate change becomes an ever more present and increasing threat, detecting these trends can tell us if our world is on the right track to reducing carbon emissions from energy generation. No doubt there is research into this topic in the public and private sector, however answers were not readily available when conducting research into this question. This blog post hopes to fill this void and provide insights into renewable energy investment trends over time. This post is by no means a comprehensive study, however it will provide some quick insights.

## Data 

The data being used is annualized totals of investment for each data point and therefore does not have a seasonal component.

```{r}
# Make file path for the data
fp <- here("_posts/2021-11-23-detecting-trends-in-renewable-energy-investment/data/IRENA_RE_Public_Investment_July2021.xlsx")

# Read in the data using the readxl package
fin_energy <- read_excel(fp)
```
```{r}
# Clean the data to remove fields that are not needed
fin_energy <- fin_energy %>% 
  clean_names() 

# Remove unnecessary columns and the "multilateral" region 
fin_energy <- fin_energy %>% 
  select(iso_code:region, year:technology, amount_2019_usd_million) %>% 
  filter(region != "Multilateral")
```

```{r}
# Separate the data into the renewable and non-renewable investments
renewable_fin <- fin_energy %>% 
  filter(category == "Renewables") %>% 
  group_by(country_area, region, year) %>% 
  summarise(country_sum = sum(amount_2019_usd_million))

non_renewable_fin <- fin_energy %>% 
  filter(category =="Non-renewables") %>% 
  group_by(country_area, region, year) %>% 
  summarise(country_sum = sum(amount_2019_usd_million))
```

```{r}
# Make data table for renewables for by region
region_renewable_fin <- renewable_fin %>% 
  group_by(region, year) %>% 
  summarise(region_sum = sum(country_sum))

# Make data table for non-renewables for by region
region_non_renewable_fin <- non_renewable_fin %>% 
  group_by(region, year) %>% 
  summarise(region_sum = sum(country_sum))
```

## Analysis Plan

First, a simple static time series model will explore the overall trend of the total annual amount invested in renewable energy by region. Regions are broken into Africa, Asia, Central America and the Caribbean, Eurasia, Europe, Middle East, Oceania, and South America.  By running this simple model we can get a quick glimpse into the global trend of renewable investment. This assumes that only the immediate year in question has an effect on the quantity of investment. This will then be compared to the trend in non-renewable energy source investment over the same time period.

Second, a more complex model time series model will be made where we take the simple model and break it up by regional heterogeneity to produce an interaction model. As mentioned earlier, it is no secret that change usually occurs where money flows. Our first trend model provides us with a quick insight into how the world is investing as a whole. However, with agreements like The Paris Agreement we know it will take each country's and region's participation to minimize and eventually reverse the effects of climate change. With this in mind, the simple model produced earlier hides that certain regions are committing greater investments than other regions. If regions are truly committed to curbing climate change our model will show an overall positive trend. This evaluation will serve as a litmus test to see regional commitment to global climate agreements. Finally, regional renewable trends will then be compared to their non-renewable counterparts.

## Results
### Simple Renewable Investment Trend Model
```{r}
# Lets make our simple model for renewable energy
model_renew <- lm(region_sum ~ year, data = region_renewable_fin)

summary_model_renew <- summary(model_renew)
summary_model_renew
```
```{r}
# Test for tab_model to determine if it is better to use
tab_model(model_renew, title = "Effect of Time on Renewable Investment")
```

Using the `summary()` function, we can quickly get some insights from our model. From the output above we are most concerned with the coefficient estimate of the year, which is `r round(summary_model_renew$coefficients[2,"Estimate"], 2)` million USD. This tells us that, according to this model, with each passing year we are seeing a increase in renewable investment by more than 142,000,000 USD across each region per year. Overall this is a positive trend for renewable investments year over year.

From the `summary()` function we are also able to get a p-value for the trend coefficient. The p-value is represented in the "Coefficients" section of the table under "Pr(>|t|)". The year coefficient has a p-value below 0.001 which gives us confidence in rejecting a null hypothesis that there is no relationship between investment sums across time with a significance level of 0.05. It should be noted that our R-squared value for this model is 0.13 however that is not important for this analysis as we are not focused on predicting outcomes of investment with high precision, but rather the overall trend from the year coefficient and its' associated p-value.

Now that we can see that there is a positive trend in renewable investments, lets compare that to non-renewable investment.

### Simple Non-renewable Investment Model
```{r}
# Lets make a model for non-renewables
model_non_renew <- lm(region_sum ~ year, data = region_non_renewable_fin)

summary_model_non_renew <- summary(model_non_renew)
summary_model_non_renew
```
From the `summary()` of this model we can see that by country there is also a positive trend of non-renewable investment across regions. According to this model there is an increase in non-renewable investments by `r round(summary_model_non_renew$coefficients[2,"Estimate"], 2)` million USD. With a p-value of 0.005 can confidently reject a null hypothesis of there being no relationship between non-renewable investment over time with a significance level of 0.05. According to these two simple models, there is a larger increase in renewable investments year over year compared to non-renewables but as the standard errors for the models overlap this is not conclusive and this blog post will not be pursuing this question. Below is a plot that compares renewable and non-renewable investments over time, along with their respective models.

```{r}
simple_model_plot <- ggplot(data = region_renewable_fin, 
                            aes(x = year, y = region_sum)) + 
  geom_point(color = "darkgreen", 
             alpha = 0.8) + 
  geom_line(data = augment(model_renew), 
             aes( y = .fitted), 
             color = "darkgreen") +
  geom_point(data = region_non_renewable_fin, 
             aes(x = year, y = region_sum), 
             color = "tan3",
             alpha = 0.8) +
    geom_line(data = augment(model_non_renew), 
             aes( y = .fitted), 
             color = "tan3") +
  labs(caption = "Renewable investments from 2000-2020 are increasing at a rate of 141 million USD per year according to this model.\nNon-renewable invesments over the same time period are increasing at a rate of 110 million USD per year.", 
       title = "Comparing Investment Renewable and Non-Renewable Energy Investment
Across Regional Sums") +
  xlab(label = "Year") +
  ylab(label = "Annual Regional Sum of Investment (million USD)") +
  theme_bw() +
  scale_color_discrete(name = "Energy Source", 
                       breaks = c("Renewables", "Non-Renewables"),
                       labels = c("Renewables", "Non-Renewables")) + 
  theme(plot.caption = element_text(hjust = 0))
  
  
simple_model_plot
```

It can be observed from the graph that there has been significant investment in renewable (green) and non-renewable (tan) energy projects since the 2008 recession. The plot illustrates just how much variance there is in investment totals across regions in each year. As discussed above the plot does show that there is a larger investment in renewables year-over-year. As this data is only from the years 2000-2020 these investment trends do not reflect the historical investments in non-renewable energy sources. As this simple regression only looks at the trend over time we will now see how these investment trends compare across regions. In the original model outlier regional trends could be affecting our simple investment trend.

### Regional Renewable Investment
Below the same `summary()` function is used to quickly provide some summary statistics for the interaction regression of time and region on renewable investment trends. In the model the North American region was set as the base level of the regression. This was done because North America contains the United States, the country with the largest GDP in the world and therefore a significant marker to compare other regions to it.

```{r}
# Make levels for regions with North America as first to compare our region to the rest of the world
region_renewable_fin$region <- factor(region_renewable_fin$region, levels = c("North America", "Africa", "Asia", "Central America and the Caribbean", "Eurasia", "Europe", "Middle East", "Oceania", "South America"))

# Make the regional investment model
region_model <-  lm(region_sum ~ year + region:year, data = region_renewable_fin)
region_renew_model_summary <- summary(region_model)
region_renew_model_summary
```
From the summary intercept estimates, only Oceania is investing less per year than North America. However, the p-value for the Oceania region is greater than the significance level of 0.05 and therefore we cannot say its represented rate of renewable investment is statistically significant and we fail to reject a null hypothesis that there is no difference in investment over time. As useful as the `summary()` function is, it is not easy to compare regional investment trends with it so the below table was made to show each regions rate of renewable investment according to this model and its corresponding p-value. 

```{r}
# Making the results a summary table
summary_renew_region_table <- data.frame(Region = c("North America", 
                                                      "Africa", 
                                                      "Asia", 
                                                      "Central America and the Caribbean", 
                                                      "Eurasia", 
                                                      "Europe", 
                                                      "Middle East", 
                                                      "Oceania", 
                                                      "South America"), 
                                         Renewable_Investment = c(region_renew_model_summary$coefficients[2,"Estimate"], 
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[3,"Estimate"],
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[4,"Estimate"],
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[5,"Estimate"],
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[6,"Estimate"],
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[7,"Estimate"],
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[8,"Estimate"],
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[9,"Estimate"],
                                                                  region_renew_model_summary$coefficients[2,"Estimate"] + region_renew_model_summary$coefficients[10,"Estimate"]),
                                         p_value = c(region_renew_model_summary$coefficients[2,"Pr(>|t|)"], 
                                                                                         region_renew_model_summary$coefficients[3,"Pr(>|t|)"],
                                                                                         region_renew_model_summary$coefficients[4,"Pr(>|t|)"],
                                                                                         region_renew_model_summary$coefficients[5,"Pr(>|t|)"],
                                                                                         region_renew_model_summary$coefficients[6,"Pr(>|t|)"],
                                                                                         region_renew_model_summary$coefficients[7,"Pr(>|t|)"],
                                                                                         region_renew_model_summary$coefficients[8,"Pr(>|t|)"],
                                                                                         region_renew_model_summary$coefficients[9,"Pr(>|t|)"],
                                                                                         region_renew_model_summary$coefficients[10,"Pr(>|t|)"])
) %>% 
  mutate(Renewable_Investment = round(Renewable_Investment, 2))

summary_renew_region_table %>% 
  kable(col.names = c("Region", "Renewable Investment per Year (million USD)", "p-value")) %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
```

From this table we can observe that the projected investment rates per year are quite similar across each region and are too close to draw conclusions. It should be noted however that these seemingly small differences would illuminate themselves more over time and this will be represented in a graphical representation of this regression below. The most important takeaway from the table above is that we can say the regions of North America, Africa, Asia, Europe, and South America all have p -values below a significance level of 0.05 and therefore are significantly significant. The regions of Central America and the Caribbean, Eurasia, the Middle East, and Oceania all have significant levels greater than 0.05 and therefore we fail to reject a null hypothesis for these regions and cannot say that they are increasing their investment in renewable energy over time. Below is a plot of the regional investment across time model.

```{r}
# Plotting the regional model
regional_model_plot <- ggplot(data = region_renewable_fin, 
                            aes(x = year, y = region_sum, color = region)) + 
  geom_point() + 
  geom_line(data = augment(region_model), 
             aes(y = .fitted)) + 
  scale_color_paletteer_d("colorBlindness::paletteMartin") +
  labs(caption = "Renewable investments from 2000-2020 are increasing over time for North America, Africa, Asia, Europe, and\nSouth America. The model suggests the same for Central America and the Caribbean, Eurasia, the Middle East,\nand Oceania however, they have p-values greater than the significance level of 0.05.",
       title = "Determining the Rate of Renewable Investment Over Time by Each Region") +
  xlab(label = "Year") +
  ylab(label = "Annual Regional Sum of Investment (million USD)") +
  theme_bw() + 
  theme(plot.caption = element_text(hjust = 0)) + 
  guides(color = guide_legend(title = "Region"))

regional_model_plot
```

Based on the regional interaction model above we are next going to do the same for non-renewable energy investment and will summarize them into one output table with the renewables investment regression.

```{r}
# Make levels for regions with North America as first to compare our region to the rest of the world
region_non_renewable_fin$region <- factor(region_non_renewable_fin$region, levels = c("North America", "Africa", "Asia", "Central America and the Caribbean", "Eurasia", "Europe", "Middle East", "Oceania", "South America"))

# Make the regional investment model
region_non_renew_model <-  lm(region_sum ~ year + region:year, data = region_non_renewable_fin)
region_non_renew_model_summary <- summary(region_non_renew_model)
```

```{r}
summary_investment_region_table <-  data.frame(summary_renew_region_table, 
                                               Non_Renewable_Investment = c(region_non_renew_model_summary$coefficients[2,"Estimate"], 
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[3,"Estimate"],
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[4,"Estimate"],
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[5,"Estimate"],
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[6,"Estimate"],
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[7,"Estimate"],
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[8,"Estimate"],
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[9,"Estimate"],
                                                                  region_non_renew_model_summary$coefficients[2,"Estimate"] + region_non_renew_model_summary$coefficients[10,"Estimate"]), 
                                               Non_Renewable_p_value = c(region_non_renew_model_summary$coefficients[2,"Pr(>|t|)"], 
                                                                         region_non_renew_model_summary$coefficients[3,"Pr(>|t|)"],
                                                                         region_non_renew_model_summary$coefficients[4,"Pr(>|t|)"],
                                                                         region_non_renew_model_summary$coefficients[5,"Pr(>|t|)"],
                                                                         region_non_renew_model_summary$coefficients[6,"Pr(>|t|)"],
                                                                         region_non_renew_model_summary$coefficients[7,"Pr(>|t|)"],
                                                                         region_non_renew_model_summary$coefficients[8,"Pr(>|t|)"],
                                                                         region_non_renew_model_summary$coefficients[9,"Pr(>|t|)"],
                                                                         region_non_renew_model_summary$coefficients[10,"Pr(>|t|)"])) %>% 
  mutate(Non_Renewable_Investment = round(Non_Renewable_Investment, 2))
```

```{r}
summary_investment_region_table %>% 
  kable(col.names = c("Region", 
                      "Renewable Investment per Year (million USD)", 
                      "Renewable p-value",
                      "Non-renewable Investment per Year (million USD)",
                      "Non-renewable p-value")) %>% 
  kable_styling(bootstrap_options = "striped", 
                full_width = FALSE) %>% 
  column_spec(column = 2, width = "2in") %>% 
  column_spec(column = 4, width = "2in")

```

The above table allows for the comparison of the rates of renewable and non-renewable investments over time by each region and their corresponding p-values. Based on the non-renewable data, the rates of investment for every region except North America and Asia have p-values greater than the significance level of 0.05. Therefore only the rates for North America and Asia can be considered statistically significant while the others are not.

## Next Steps

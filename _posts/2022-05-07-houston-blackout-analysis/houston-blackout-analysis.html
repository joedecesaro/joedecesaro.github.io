<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Houston Blackout Analysis (February 2021)</title>

  <meta property="description" itemprop="description" content="Using night light data from NASA&#39;s Worldview to identify residences in the Houston metropolitan area that lost power during the major blackout in February 2021."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-10-24"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-10-24"/>
  <meta name="article:author" content="Joe DeCesaro"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Houston Blackout Analysis (February 2021)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Using night light data from NASA&#39;s Worldview to identify residences in the Houston metropolitan area that lost power during the major blackout in February 2021."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Houston Blackout Analysis (February 2021)"/>
  <meta property="twitter:description" content="Using night light data from NASA&#39;s Worldview to identify residences in the Houston metropolitan area that lost power during the major blackout in February 2021."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","categories","preview"]}},"value":[{"type":"character","attributes":{},"value":["Houston Blackout Analysis (February 2021)"]},{"type":"character","attributes":{},"value":["Using night light data from NASA's Worldview to identify residences in the Houston metropolitan area that lost power during the major blackout in February 2021.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Joe DeCesaro"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["10-24-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","code_folding","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["R","Spatial Analysis","Remote Sensing"]},{"type":"character","attributes":{},"value":["images/blackout_map.png"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000001.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000001.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000001.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000001.TablesByName.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000002.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000002.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000003.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000003.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000003.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.CatItemsByPhysicalName.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.CatItemsByType.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.FDO_UUID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.freelist","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000004.spx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000005.CatItemTypesByName.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000005.CatItemTypesByParentTypeID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000005.CatItemTypesByUUID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000005.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000005.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000005.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000006.CatRelsByDestinationID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000006.CatRelsByOriginID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000006.CatRelsByType.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000006.FDO_UUID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000006.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000006.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000006.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.CatRelTypesByBackwardLabel.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.CatRelTypesByDestItemTypeID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.CatRelTypesByForwardLabel.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.CatRelTypesByName.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.CatRelTypesByOriginItemTypeID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.CatRelTypesByUUID.atx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000007.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000009.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000009.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000009.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000a.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000a.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000a.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000b.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000b.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000b.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000c.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000c.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000c.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000d.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000d.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000d.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000e.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000e.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000e.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000f.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000f.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000000f.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000010.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000010.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000010.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000011.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000011.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000011.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000012.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000012.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000012.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000013.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000013.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000013.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000014.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000014.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000014.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000015.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000015.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000015.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000016.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000016.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000016.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000017.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000017.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000017.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000018.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000018.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000018.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000019.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000019.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000019.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001a.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001a.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001a.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001b.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001b.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001b.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001c.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001c.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001c.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001d.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001d.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001d.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001e.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001e.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001e.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001f.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001f.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a0000001f.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000020.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000020.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000020.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000021.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000021.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000021.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000022.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000022.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000022.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000023.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000023.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000023.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000024.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000024.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000024.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000025.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000025.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000025.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000026.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000026.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000026.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000027.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000027.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000027.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000028.freelist","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000028.gdbindexes","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000028.gdbtable","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000028.gdbtablx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/a00000028.spx","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/gdb","data/ACS_2019_5YR_TRACT_48_TEXAS.gdb/timestamps","data/gis_osm_buildings_a_free_1.gpkg","data/gis_osm_roads_free_1.gpkg","data/VNP46A1/VNP46A1.A2021038.h08v05.001.2021039064328.h5","data/VNP46A1/VNP46A1.A2021038.h08v06.001.2021039064329.h5","data/VNP46A1/VNP46A1.A2021047.h08v05.001.2021048091106.h5","data/VNP46A1/VNP46A1.A2021047.h08v06.001.2021048091105.h5","houston-blackout-analysis_files/anchor-4.2.2/anchor.min.js","houston-blackout-analysis_files/bowser-1.9.3/bowser.min.js","houston-blackout-analysis_files/distill-2.2.21/template.v2.js","houston-blackout-analysis_files/figure-html5/unnamed-chunk-16-1.png","houston-blackout-analysis_files/figure-html5/unnamed-chunk-19-1.png","houston-blackout-analysis_files/header-attrs-2.10/header-attrs.js","houston-blackout-analysis_files/htmlwidgets-1.5.3/htmlwidgets.js","houston-blackout-analysis_files/jquery-1.11.3/jquery.min.js","houston-blackout-analysis_files/jquery-1.12.4/jquery.min.js","houston-blackout-analysis_files/leaflet-1.3.1/images/layers-2x.png","houston-blackout-analysis_files/leaflet-1.3.1/images/layers.png","houston-blackout-analysis_files/leaflet-1.3.1/images/marker-icon-2x.png","houston-blackout-analysis_files/leaflet-1.3.1/images/marker-icon.png","houston-blackout-analysis_files/leaflet-1.3.1/images/marker-shadow.png","houston-blackout-analysis_files/leaflet-1.3.1/leaflet.css","houston-blackout-analysis_files/leaflet-1.3.1/leaflet.js","houston-blackout-analysis_files/leaflet-binding-2.0.4.1/leaflet.js","houston-blackout-analysis_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js","houston-blackout-analysis_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js","houston-blackout-analysis_files/leafletfix-1.0.0/leafletfix.css","houston-blackout-analysis_files/popper-2.6.0/popper.min.js","houston-blackout-analysis_files/proj4-2.6.2/proj4.min.js","houston-blackout-analysis_files/Proj4Leaflet-1.0.1/proj4leaflet.js","houston-blackout-analysis_files/rstudio_leaflet-1.3.1/images/1px.png","houston-blackout-analysis_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css","houston-blackout-analysis_files/tippy-6.2.7/tippy-bundle.umd.min.js","houston-blackout-analysis_files/tippy-6.2.7/tippy-light-border.css","houston-blackout-analysis_files/tippy-6.2.7/tippy.css","houston-blackout-analysis_files/tippy-6.2.7/tippy.umd.min.js","houston-blackout-analysis_files/webcomponents-2.0.0/webcomponents.js","images/blackout_map.png","rosm.cache/osm/9_118_210.png","rosm.cache/osm/9_118_211.png","rosm.cache/osm/9_118_212.png","rosm.cache/osm/9_119_210.png","rosm.cache/osm/9_119_211.png","rosm.cache/osm/9_119_212.png","rosm.cache/osm/9_120_210.png","rosm.cache/osm/9_120_211.png","rosm.cache/osm/9_120_212.png","rosm.cache/osm/9_121_210.png","rosm.cache/osm/9_121_211.png","rosm.cache/osm/9_121_212.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="houston-blackout-analysis_files/header-attrs-2.10/header-attrs.js"></script>
  <script src="houston-blackout-analysis_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="houston-blackout-analysis_files/popper-2.6.0/popper.min.js"></script>
  <link href="houston-blackout-analysis_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="houston-blackout-analysis_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="houston-blackout-analysis_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="houston-blackout-analysis_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="houston-blackout-analysis_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="houston-blackout-analysis_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="houston-blackout-analysis_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Houston Blackout Analysis (February 2021)","description":"Using night light data from NASA's Worldview to identify residences in the Houston metropolitan area that lost power during the major blackout in February 2021.","authors":[{"author":"Joe DeCesaro","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-10-24T00:00:00.000+00:00","citationText":"DeCesaro, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Houston Blackout Analysis (February 2021)</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">R</div>
<div class="dt=tag">Spatial Analysis</div>
<div class="dt=tag">Remote Sensing</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Using night light data from NASAs Worldview to identify
residences in the Houston metropolitan area that lost power during the
major blackout in February 2021.</p></p>
</div>

<div class="d-byline">
  Joe DeCesaro true 
  
<br/>10-24-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#the-analysis">The Analysis</a>
<ul>
<li><a href="#load-libraries">Load Libraries</a></li>
<li><a
href="#function-to-load-the-dnb-dataset-from-vnp46a1-granules">Function
to Load the DNB Dataset from VNP46A1 Granules</a></li>
<li><a href="#load-in-the-satellite-data-tilenumber_mm_dd">Load in the
Satellite Data: tilenumber_mm_dd</a>
<ul>
<li><a href="#combine-tiles-by-day">Combine Tiles by Day</a></li>
<li><a href="#create-a-blackout-mask">Create a Blackout Mask</a></li>
<li><a href="#vectorize-the-blackout-mask">Vectorize the Blackout
Mask</a></li>
<li><a
href="#crop-the-vectorized-mask-with-the-region-of-interest-roi">Crop
the Vectorized Mask with the Region of Interest (ROI)</a></li>
<li><a href="#spatial-subsetting">Spatial Subsetting</a></li>
</ul></li>
<li><a href="#read-in-and-process-the-roads-data">Read in and Process
the Roads Data</a>
<ul>
<li><a
href="#function-to-load-the-doads-data-from-openstreetmap">Function to
Load the Doads Data from OpenStreetMap</a></li>
<li><a href="#buffer-the-roads">Buffer the roads</a></li>
</ul></li>
<li><a href="#read-in-and-process-the-buildings-data">Read in and
Process the Buildings Data</a>
<ul>
<li><a
href="#function-to-load-the-buildings-data-from-openstreetmap">Function
to Load the Buildings Data from OpenStreetMap</a></li>
<li><a href="#reprojecting-the-residences-data">Reprojecting the
Residences Data</a></li>
</ul></li>
<li><a href="#read-in-the-census-tract-data">Read in the Census tract
data</a></li>
<li><a href="#merge-the-datasets">Merge the Datasets</a>
<ul>
<li><a
href="#merge-the-night-lights-data-the-buffered-highways-and-the-residences">Merge
the Night Lights Data, the Buffered Highways, and the
Residences</a></li>
<li><a
href="#merge-the-census-tract-geometries-with-the-census-income-data">Merge
the census tract geometries with the census income data</a></li>
</ul></li>
<li><a
href="#question-1-how-many-residential-buildings-were-without-power-on-2021-02-16">Question
1: How many residential buildings were without power on
2021-02-16?</a></li>
<li><a
href="#question-2-is-there-a-socioeconomic-metric-that-predicts-being-affected-by-the-power-outage">Question
2: Is there a socioeconomic metric that predicts being affected by the
power outage?</a></li>
<li><a href="#conclusions">Conclusions</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="the-analysis">The Analysis</h1>
<p>In this assignment for our Spatial Analysis class, we use
remotely-sensed light data from NASAs Worldview to identify residences
in the Houston metropolitan area that lost power during the major
blackout in February 2021. The goal of the analysis is to:</p>
<ol type="1">
<li>Estimate how many residential buildings were without power on
2021/02/16?</li>
<li>Is there a socioeconomic metric that predicts being affected by the
power outage?</li>
</ol>
<p>The data was specifically acquired from the Visible Infrared Imaging
Radiometer Suite (VIIRS) on the Suomi satellite. Using highways data
from Open Street Map, residences within 200 meters of a major highway
were excluded. Residence building count was based on Open Street Maps
buildings data. Lastly, a few socioeconomic indicators from census data
is explored for correlations with likelihood of being impacted by the
blackout.</p>
<h2 id="load-libraries">Load Libraries</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/sf/'>sf</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-spatial.github.io/stars/'>stars</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/raster'>raster</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/mtennekes/tmap'>tmap</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/paleolimbot/rosm'>rosm</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="function-to-load-the-dnb-dataset-from-vnp46a1-granules">Function
to Load the DNB Dataset from VNP46A1 Granules</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>read_dnb</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>file_name</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># Reads the "DNB_At_Sensor_Radiance_500m" dataset from a VNP46A1 granule into a STARS object.</span>
  <span class='co'># Then read the sinolsoidal tile x/y positions and adjust the STARS dimensions (extent+delta)</span>

  <span class='co'># The name of the dataset holding the nightlight band in the granule</span>
  <span class='va'>dataset_name</span> <span class='op'>&lt;-</span> <span class='st'>"//HDFEOS/GRIDS/VNP_Grid_DNB/Data_Fields/DNB_At_Sensor_Radiance_500m"</span>

  <span class='co'># From the metadata, we pull out a string containing the horizontal and vertical tile index</span>
  <span class='va'>h_string</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/gdal.html'>gdal_metadata</a></span><span class='op'>(</span><span class='va'>file_name</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>199</span><span class='op'>]</span>
  <span class='va'>v_string</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/gdal.html'>gdal_metadata</a></span><span class='op'>(</span><span class='va'>file_name</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>219</span><span class='op'>]</span>
  
  <span class='co'># We parse the h/v string to pull out the integer number of h and v</span>
  <span class='va'>tile_h</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'>str_split</span><span class='op'>(</span><span class='va'>h_string</span>, <span class='st'>"="</span>, simplify <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>tile_v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'>str_split</span><span class='op'>(</span><span class='va'>v_string</span>, <span class='st'>"="</span>, simplify <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>

  <span class='co'># From the h/v tile grid position, we get the offset and the extent</span>
  <span class='va'>west</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fl'>10</span> <span class='op'>*</span> <span class='va'>tile_h</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>180</span>
  <span class='va'>north</span> <span class='op'>&lt;-</span> <span class='fl'>90</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>10</span> <span class='op'>*</span> <span class='va'>tile_v</span><span class='op'>)</span>
  <span class='va'>east</span> <span class='op'>&lt;-</span> <span class='va'>west</span> <span class='op'>+</span> <span class='fl'>10</span>
  <span class='va'>south</span> <span class='op'>&lt;-</span> <span class='va'>north</span> <span class='op'>-</span> <span class='fl'>10</span>

  <span class='co'># A tile is 10 degrees and has 2400x2400 grid cells</span>
  <span class='va'>delta</span> <span class='op'>&lt;-</span> <span class='fl'>10</span> <span class='op'>/</span> <span class='fl'>2400</span>

  <span class='co'># Reading the dataset</span>
  <span class='va'>dnb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/stars/reference/read_stars.html'>read_stars</a></span><span class='op'>(</span><span class='va'>file_name</span>, sub <span class='op'>=</span> <span class='va'>dataset_name</span><span class='op'>)</span>

  <span class='co'># Setting the CRS and applying offsets and deltas</span>
  <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_crs.html'>st_crs</a></span><span class='op'>(</span><span class='va'>dnb</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_crs.html'>st_crs</a></span><span class='op'>(</span><span class='fl'>4326</span><span class='op'>)</span>
  <span class='fu'><a href='https://r-spatial.github.io/stars/reference/st_dimensions.html'>st_dimensions</a></span><span class='op'>(</span><span class='va'>dnb</span><span class='op'>)</span><span class='op'>$</span><span class='va'>x</span><span class='op'>$</span><span class='va'>delta</span> <span class='op'>&lt;-</span> <span class='va'>delta</span>
  <span class='fu'><a href='https://r-spatial.github.io/stars/reference/st_dimensions.html'>st_dimensions</a></span><span class='op'>(</span><span class='va'>dnb</span><span class='op'>)</span><span class='op'>$</span><span class='va'>x</span><span class='op'>$</span><span class='va'>offset</span> <span class='op'>&lt;-</span> <span class='va'>west</span>
  <span class='fu'><a href='https://r-spatial.github.io/stars/reference/st_dimensions.html'>st_dimensions</a></span><span class='op'>(</span><span class='va'>dnb</span><span class='op'>)</span><span class='op'>$</span><span class='va'>y</span><span class='op'>$</span><span class='va'>delta</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='va'>delta</span>
  <span class='fu'><a href='https://r-spatial.github.io/stars/reference/st_dimensions.html'>st_dimensions</a></span><span class='op'>(</span><span class='va'>dnb</span><span class='op'>)</span><span class='op'>$</span><span class='va'>y</span><span class='op'>$</span><span class='va'>offset</span> <span class='op'>&lt;-</span> <span class='va'>north</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>dnb</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<h2 id="load-in-the-satellite-data-tilenumber_mm_dd">Load in the
Satellite Data: tilenumber_mm_dd</h2>
<p>Next we load the four tiles that give us a complete image of Houston
on 2021-02-07 and 2021-02-16. We save the tiles under the naming
convention <code>tilenumber_mm_dd</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>file_name</span> <span class='op'>&lt;-</span> <span class='st'>"data/VNP46A1/VNP46A1.A2021038.h08v05.001.2021039064328.h5"</span>
<span class='va'>t05_02_07</span> <span class='op'>&lt;-</span> <span class='fu'>read_dnb</span><span class='op'>(</span>file_name <span class='op'>=</span> <span class='va'>file_name</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>//HDFEOS/GRIDS/VNP_Grid_DNB/Data_Fields/DNB_At_Sensor_Radiance_500m, </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>file_name</span> <span class='op'>&lt;-</span> <span class='st'>"data/VNP46A1/VNP46A1.A2021038.h08v06.001.2021039064329.h5"</span>
<span class='va'>t06_02_07</span> <span class='op'>&lt;-</span> <span class='fu'>read_dnb</span><span class='op'>(</span>file_name <span class='op'>=</span> <span class='va'>file_name</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>//HDFEOS/GRIDS/VNP_Grid_DNB/Data_Fields/DNB_At_Sensor_Radiance_500m, </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>file_name</span> <span class='op'>&lt;-</span> <span class='st'>"data/VNP46A1/VNP46A1.A2021047.h08v05.001.2021048091106.h5"</span>
<span class='va'>t05_02_16</span> <span class='op'>&lt;-</span> <span class='fu'>read_dnb</span><span class='op'>(</span>file_name <span class='op'>=</span> <span class='va'>file_name</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>//HDFEOS/GRIDS/VNP_Grid_DNB/Data_Fields/DNB_At_Sensor_Radiance_500m, </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>file_name</span> <span class='op'>&lt;-</span> <span class='st'>"data/VNP46A1/VNP46A1.A2021047.h08v06.001.2021048091105.h5"</span>
<span class='va'>t06_02_16</span> <span class='op'>&lt;-</span> <span class='fu'>read_dnb</span><span class='op'>(</span>file_name <span class='op'>=</span> <span class='va'>file_name</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>//HDFEOS/GRIDS/VNP_Grid_DNB/Data_Fields/DNB_At_Sensor_Radiance_500m, </code></pre>
</div>
<h3 id="combine-tiles-by-day">Combine Tiles by Day</h3>
<p><code>st_mosaic()</code> is used to combine the tiles for each day to
provide a complete picture of Houston on each day, then we use
<code>rm()</code> to clear the large original tiles.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>combined_02_07</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/stars/reference/st_mosaic.html'>st_mosaic</a></span><span class='op'>(</span><span class='va'>t05_02_07</span>, <span class='va'>t06_02_07</span><span class='op'>)</span>

<span class='va'>combined_02_16</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/stars/reference/st_mosaic.html'>st_mosaic</a></span><span class='op'>(</span><span class='va'>t05_02_16</span>, <span class='va'>t06_02_16</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>t05_02_07</span>, <span class='va'>t06_02_07</span>, <span class='va'>t05_02_16</span>, <span class='va'>t06_02_16</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>           used  (Mb) gc trigger  (Mb) limit (Mb) max used  (Mb)
Ncells  2823284 150.8    4537211 242.4         NA  4537211 242.4
Vcells 26971733 205.8   63966646 488.1      16384 61692780 470.7</code></pre>
</div>
<h3 id="create-a-blackout-mask">Create a Blackout Mask</h3>
<p>To create a blackout mask, we identify cells where the difference in
DNB between 2021-02-07 and 2021-02-16 is greater than 200 nW cm^-2
sr^-1. Where the difference is less than this threshold, we assign a
value of NA.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>difference_mask</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>combined_02_07</span> <span class='op'>-</span> <span class='va'>combined_02_16</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>200</span>

<span class='va'>difference_mask</span><span class='op'>[</span><span class='va'>difference_mask</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>combined_02_07</span>,<span class='va'>combined_02_16</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>          used  (Mb) gc trigger  (Mb) limit (Mb) max used  (Mb)
Ncells 2824193 150.9    4537211 242.4         NA  4537211 242.4
Vcells 9693966  74.0   54104736 412.8      16384 67630920 516.0</code></pre>
</div>
<h3 id="vectorize-the-blackout-mask">Vectorize the Blackout Mask</h3>
<p>We use <code>st_as_sf()</code> to vectorize the blackout mask and
then <code>st_make_valid()</code> to repair the geometries of some of
the polygons in the resulting vectorized mask.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>difference_mask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='va'>difference_mask</span><span class='op'>)</span>

<span class='va'>difference_mask</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/valid.html'>st_make_valid</a></span><span class='op'>(</span><span class='va'>difference_mask</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="crop-the-vectorized-mask-with-the-region-of-interest-roi">Crop
the Vectorized Mask with the Region of Interest (ROI)</h3>
<p>We create a bounding box of the Houston metropolitan area and then
give it a CRS of WGS 84 (for the time being).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>roi</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st.html'>st_polygon</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>96.5</span>, <span class='fl'>29</span><span class='op'>)</span>, 
                            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>96.5</span>, <span class='fl'>30.5</span><span class='op'>)</span>, 
                            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>94.5</span>, <span class='fl'>30.5</span><span class='op'>)</span>, 
                            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>94.5</span>, <span class='fl'>29</span><span class='op'>)</span>, 
                            <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>96.5</span>, <span class='fl'>29</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># plot(roi)</span>

<span class='va'>roi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/sfc.html'>st_sfc</a></span><span class='op'>(</span><span class='va'>roi</span>, crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h3 id="spatial-subsetting">Spatial Subsetting</h3>
<p>Using our bounding box, we create a cropped difference mask by
keeping only the values of the cells that intersect the bounding box,
then we use <code>st_transform()</code> to give the cropped data a
projected CRS of NAD83/Texas Centric Albers.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>intersects</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_binary_pred.html'>st_intersects</a></span><span class='op'>(</span><span class='va'>difference_mask</span>, <span class='va'>roi</span>, sparse <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>cropped</span> <span class='op'>=</span> <span class='va'>difference_mask</span><span class='op'>[</span><span class='va'>intersects</span>,<span class='op'>]</span>

<span class='va'>crs</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_crs.html'>st_crs</a></span><span class='op'>(</span><span class='fl'>3083</span><span class='op'>)</span>
<span class='va'>cropped</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_transform.html'>st_transform</a></span><span class='op'>(</span><span class='va'>cropped</span>, <span class='va'>crs</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>difference_mask</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>          used  (Mb) gc trigger  (Mb) limit (Mb)  max used   (Mb)
Ncells 3060540 163.5    4537211 242.4         NA   4537211  242.4
Vcells 4454639  34.0  110598994 843.9      16384 133455011 1018.2</code></pre>
</div>
<h2 id="read-in-and-process-the-roads-data">Read in and Process the
Roads Data</h2>
<h3 id="function-to-load-the-doads-data-from-openstreetmap">Function to
Load the Doads Data from OpenStreetMap</h3>
<p>We use the SQL query provided to us from the class to read in the
data where the column <code>fclass</code> is motorway in the OSM roads
dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>query_r</span> <span class='op'>&lt;-</span> <span class='st'>"SELECT * FROM gis_osm_roads_free_1 WHERE fclass='motorway'"</span>
<span class='va'>highways</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_read.html'>st_read</a></span><span class='op'>(</span><span class='st'>"data/gis_osm_roads_free_1.gpkg"</span>, query <span class='op'>=</span> <span class='va'>query_r</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Reading query `SELECT * FROM gis_osm_roads_free_1 WHERE fclass=&#39;motorway&#39;&#39; from data source `/Users/Joe/Documents/Bren/Website/joedecesaro.github.io/_posts/2022-05-07-houston-blackout-analysis/data/gis_osm_roads_free_1.gpkg&#39; 
  using driver `GPKG&#39;
Simple feature collection with 6085 features and 10 fields
Geometry type: LINESTRING
Dimension:     XY
Bounding box:  xmin: -96.50429 ymin: 29.00174 xmax: -94.39619 ymax: 30.50886
Geodetic CRS:  WGS 84</code></pre>
</div>
<h3 id="buffer-the-roads">Buffer the roads</h3>
<p>Next, we use <code>st_transform()</code> to reproject the data to
NAD83/Texas Centric Albers, then create a buffer of 200 m around the
highways.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#st_crs(highways)</span>

<span class='va'>highways</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_transform.html'>st_transform</a></span><span class='op'>(</span><span class='va'>highways</span>, <span class='va'>crs</span><span class='op'>)</span>

<span class='va'>highways_buffered</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_combine.html'>st_union</a></span><span class='op'>(</span><span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_unary.html'>st_buffer</a></span><span class='op'>(</span><span class='va'>highways</span>, dist <span class='op'>=</span> <span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>highways</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>          used  (Mb) gc trigger  (Mb) limit (Mb)  max used   (Mb)
Ncells 2916706 155.8    4537211 242.4         NA   4537211  242.4
Vcells 4284814  32.7   88479196 675.1      16384 133455011 1018.2</code></pre>
</div>
<h2 id="read-in-and-process-the-buildings-data">Read in and Process the
Buildings Data</h2>
<h3 id="function-to-load-the-buildings-data-from-openstreetmap">Function
to Load the Buildings Data from OpenStreetMap</h3>
<p>We use the SQL query provided to us in homework 2 to identify and
read in the data where the type is NULL and name is NULL, or where the
type is residential, apartments, house, static_caravan, or
detached from the OSM buildings dataset to acquire data of residences
in the Houston area.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>query_b</span> <span class='op'>&lt;-</span> <span class='st'>"SELECT * 
FROM gis_osm_buildings_a_free_1
WHERE (type IS NULL AND name IS NULL)
OR type in ('residential', 'apartments', 'house', 'static_caravan', 'detached')"</span>

<span class='va'>residences</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_read.html'>st_read</a></span><span class='op'>(</span><span class='st'>"data/gis_osm_buildings_a_free_1.gpkg"</span>, query <span class='op'>=</span> <span class='va'>query_b</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Reading query `SELECT * 
FROM gis_osm_buildings_a_free_1
WHERE (type IS NULL AND name IS NULL)
OR type in (&#39;residential&#39;, &#39;apartments&#39;, &#39;house&#39;, &#39;static_caravan&#39;, &#39;detached&#39;)&#39; from data source `/Users/Joe/Documents/Bren/Website/joedecesaro.github.io/_posts/2022-05-07-houston-blackout-analysis/data/gis_osm_buildings_a_free_1.gpkg&#39; 
  using driver `GPKG&#39;
Simple feature collection with 475941 features and 5 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -96.50055 ymin: 29.00344 xmax: -94.53285 ymax: 30.50393
Geodetic CRS:  WGS 84</code></pre>
</div>
<h3 id="reprojecting-the-residences-data">Reprojecting the Residences
Data</h3>
<p>Then, we use <code>st_transform()</code> to reproject the residences
data in NAD83/Texas Centric Albers.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>residences</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_transform.html'>st_transform</a></span><span class='op'>(</span><span class='va'>residences</span>, <span class='va'>crs</span><span class='op'>)</span>

<span class='co'>#st_crs(residences)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="read-in-the-census-tract-data">Read in the Census tract
data</h2>
<p>We explore the available census data, then read in the census tract
geometries data, as well as income data. We reproject the census tract
geometries to NAD83/Texas Centric Albers, and subset the income data to
keep the median income data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># st_layers("data/ACS_2019_5YR_TRACT_48_TEXAS.gdb")</span>

<span class='va'>acs_geoms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_read.html'>st_read</a></span><span class='op'>(</span><span class='st'>"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>,
                     layer <span class='op'>=</span> <span class='st'>"ACS_2019_5YR_TRACT_48_TEXAS"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Reading layer `ACS_2019_5YR_TRACT_48_TEXAS&#39; from data source 
  `/Users/Joe/Documents/Bren/Website/joedecesaro.github.io/_posts/2022-05-07-houston-blackout-analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb&#39; 
  using driver `OpenFileGDB&#39;
Simple feature collection with 5265 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -106.6456 ymin: 25.83716 xmax: -93.50804 ymax: 36.5007
Geodetic CRS:  NAD83</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>acs_geoms</span> <span class='op'>=</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_transform.html'>st_transform</a></span><span class='op'>(</span><span class='va'>acs_geoms</span>, <span class='va'>crs</span><span class='op'>)</span>

<span class='va'>acs_income</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_read.html'>st_read</a></span><span class='op'>(</span><span class='st'>"data/ACS_2019_5YR_TRACT_48_TEXAS.gdb"</span>,
                      layer <span class='op'>=</span> <span class='st'>"X19_INCOME"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Reading layer `X19_INCOME&#39; from data source 
  `/Users/Joe/Documents/Bren/Website/joedecesaro.github.io/_posts/2022-05-07-houston-blackout-analysis/data/ACS_2019_5YR_TRACT_48_TEXAS.gdb&#39; 
  using driver `OpenFileGDB&#39;</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>median_income</span> <span class='op'>&lt;-</span> <span class='va'>acs_income</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GEOID"</span>, <span class='st'>"B19013e1"</span><span class='op'>)</span><span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>acs_income</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>           used  (Mb) gc trigger  (Mb) limit (Mb)  max used   (Mb)
Ncells  6804540 363.5   15204982 812.1         NA  15204982  812.1
Vcells 26640844 203.3   70783357 540.1      16384 133455011 1018.2</code></pre>
</div>
<h2 id="merge-the-datasets">Merge the Datasets</h2>
<h3
id="merge-the-night-lights-data-the-buffered-highways-and-the-residences">Merge
the Night Lights Data, the Buffered Highways, and the Residences</h3>
<p>We remove the buffered highways from the blacked out night lights
data using <code>st_difference()</code>, then use
<code>st_intersects</code> to find buildings within the blacked out
night lights data that were affected by the blackout.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cropped_no_highways</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/geos_binary_ops.html'>st_difference</a></span><span class='op'>(</span><span class='va'>cropped</span>, <span class='va'>highways_buffered</span><span class='op'>)</span>

<span class='va'>affected_buildings</span> <span class='op'>&lt;-</span> <span class='va'>residences</span><span class='op'>[</span><span class='va'>cropped_no_highways</span>, op <span class='op'>=</span> <span class='va'>st_intersects</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<h3
id="merge-the-census-tract-geometries-with-the-census-income-data">Merge
the census tract geometries with the census income data</h3>
<p>We use a left join to merge the census data with the census tract
geometries, using their shared information in the columns
<code>GEOID_Data</code> and <code>GEOID</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>acs_geom_income</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>acs_geoms</span>, <span class='va'>median_income</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GEOID_Data"</span> <span class='op'>=</span> <span class='st'>"GEOID"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>acs_geoms</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/gc.html'>gc</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>           used  (Mb) gc trigger  (Mb) limit (Mb)  max used   (Mb)
Ncells  6861241 366.5   15204982 812.1         NA  15204982  812.1
Vcells 27814783 212.3   70783357 540.1      16384 133455011 1018.2</code></pre>
</div>
<h2
id="question-1-how-many-residential-buildings-were-without-power-on-2021-02-16">Question
1: How many residential buildings were without power on 2021-02-16?</h2>
<ul>
<li>The number of residential buildings that were without power on
2021-02-16 is 157411</li>
</ul>
<h2
id="question-2-is-there-a-socioeconomic-metric-that-predicts-being-affected-by-the-power-outage">Question
2: Is there a socioeconomic metric that predicts being affected by the
power outage?</h2>
<p>First we map median income by census tracts with residences affected
by the blackout:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Bounding box and basemap</span>
<span class='va'>houston_bb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_bbox.html'>st_bbox</a></span><span class='op'>(</span><span class='va'>roi</span><span class='op'>)</span>
<span class='va'>houston_map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/rosm/man/osm.image.html'>osm.raster</a></span><span class='op'>(</span><span class='va'>houston_bb</span><span class='op'>)</span>

<span class='co'># tmap::tmap_mode(mode = "plot")</span>
<span class='co'># </span>
<span class='co'># #Creating the map</span>
<span class='co'># tm_shape(houston_map) +</span>
<span class='co'>#   tm_rgb() +</span>
<span class='co'>#   tm_shape(acs_geom_income,</span>
<span class='co'>#            bbox = houston_bb) +</span>
<span class='co'>#   tm_polygons(col = "B19013e1",</span>
<span class='co'>#               title = "Median Income",</span>
<span class='co'>#               colorNA = "black",</span>
<span class='co'>#               style = "cont",</span>
<span class='co'>#               palette = "Blues") +</span>
<span class='co'>#   tm_shape(affected_buildings,</span>
<span class='co'>#            bbox = houston_bb) +</span>
<span class='co'>#   tm_polygons() + tm_style("col_blind") +</span>
<span class='co'>#   tm_layout(title = "Households Affected by Blackout and Median Income")</span>
</code></pre>
</div>
</details>
</div>
<p><img src="images/blackout_map.png" /> Note: the figure above was
originally designed to be interactive but this was changed for this post
due to excessive load times.</p>
<p><strong>Figure 1.</strong> Exploratory map showing median household
income by census tract (dark blue = high income), overlaid with
locations of residences that lost power during the February blackout.
Data is from Open Street Map and NASAs Worldview.</p>
<p>That looks interesting but its hard to identify patterns. It does
appear thata large cluster of homes in two census tracts in western
Houston lost power. This is a extreme concentration of homes that lost
power compared to other areas.Now we make a histogram of median income
for all households in the Houston metropolitan area to compare with a
histogram of median income for households impacted by the blackout:</p>
<ul>
<li>First, spatially join the residences data with the median income
data:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>residences_income</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/st_join.html'>st_join</a></span><span class='op'>(</span><span class='va'>residences</span>, <span class='va'>acs_geom_income</span>, join <span class='op'>=</span> <span class='va'>st_intersects</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<ul>
<li>Then, subset the resulting dataset to only include residences
affected by the blackout:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>impacted_residences_income</span> <span class='op'>&lt;-</span> <span class='va'>residences_income</span><span class='op'>[</span><span class='va'>cropped_no_highways</span>, op <span class='op'>=</span> <span class='va'>st_intersects</span><span class='op'>]</span>
</code></pre>
</div>
</details>
</div>
<ul>
<li>Finally, build the two histograms and display them side-by-side
using <code>patchwork</code>:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#All residences</span>
<span class='va'>histogram_residences_income</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>residences_income</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>residences_income</span><span class='op'>$</span><span class='va'>B19013e1</span><span class='op'>)</span>, bins <span class='op'>=</span> <span class='fl'>100</span>, fill <span class='op'>=</span> <span class='st'>"darkblue"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"All Houston Residences"</span>,
       x <span class='op'>=</span> <span class='st'>"Median Household Income"</span>,
       y <span class='op'>=</span> <span class='st'>"Count"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_discrete</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5000</span>,<span class='fl'>10000</span>,<span class='fl'>15000</span>,<span class='fl'>20000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20000</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#Impacted residences</span>
<span class='va'>histogram_impacted_income</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>impacted_residences_income</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_histogram</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>impacted_residences_income</span><span class='op'>$</span><span class='va'>B19013e1</span><span class='op'>)</span>, bins <span class='op'>=</span> <span class='fl'>100</span>, fill <span class='op'>=</span> <span class='st'>"darkblue"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Impacted Houston Residences"</span>,
       x <span class='op'>=</span> <span class='st'>"Median Household Income"</span>,
       y <span class='op'>=</span> <span class='st'>"Count"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_discrete</span><span class='op'>(</span>limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5000</span>,<span class='fl'>10000</span>,<span class='fl'>15000</span>,<span class='fl'>20000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>20000</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>histogram_residences_income</span> <span class='op'>+</span> <span class='va'>histogram_impacted_income</span>
</code></pre>
</div>
</details>
<p><img src="houston-blackout-analysis_files/figure-html5/unnamed-chunk-19-1.png" width="624" /></p>
</div>
<p><strong>Figure 2.</strong> Histogram showing the number of homes by
census tract median household income in the Houston metropolitan area
(left) and the number of homes impacted during the blackout by census
tract median household income (right). Data is from Open Street Map and
NASAs Worldview.</p>
<p>The impacted residences histogram shows relatively fewer low income
households impacted compared to the density of low income households in
the total area. Though the number of impacted high income households is
lower than the total high income households, it appears to be relatively
higher than impacted low income households. Interestingly, income may be
positively correlated with likelihood of being impacted. However,this
could be due to the aforementioned census tract areas where a large
percent of houses lost power.</p>
<h2 id="conclusions">Conclusions</h2>
<p>More than 150,000 residences lost power during the February blackout
in the Houston area alone. This is likely an underestimate, as
residences may have been excluded due to our highways buffer,
interference in the satellite from clouds or other atmospheric
differences, or due to our exclusion of cells where the difference was
not greater than 200 nW cm^-2 sr^-1. The socioeconomic factor that we
examined, median income, is not clearly correlated with likelihood of
being impacted by the blackout, though there may be a slight positive
correlation between income and likelihood. We also explored census race
data for white only households but there was no obvious correlation
between a household being white and likelihood of losing power. The race
data exploration and download code was removed from this document so
that the markdown was more streamlined and did not overburden the
computers.However, other socioeconomic factors that we did not examine
may have been more strongly correlated.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
